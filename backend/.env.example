# Copy this file to .env and fill in your actual values.
# See DEPLOYMENT_KEYS.md (or team docs) for production values.

# Server
PORT=3000
NODE_ENV=development
FRONTEND_URL=http://localhost:5173

# Azure Entra ID (for backend token validation)
# Must match the Azure app used by the frontend (same app registration as MSAL).
# Use the same Client ID as VITE_MSAL_CLIENT_ID and the same tenant as your app registration.
AZURE_TENANT_ID=your-tenant-id
AZURE_CLIENT_ID=your-client-id

# Cosmos DB
COSMOS_ENDPOINT=https://your-account.documents.azure.com:443/
COSMOS_KEY=your-primary-key-here
COSMOS_DATABASE=echopad
COSMOS_CONTAINER=users

# Google OAuth - set in GitHub Secrets as PROD_VITE_GOOGLE_CLIENT_ID / DEV_VITE_GOOGLE_CLIENT_ID.
# Backend gets GOOGLE_CLIENT_ID from the deploy workflow (same value as frontend). For local dev only:
# GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com

# Magic Link (passwordless email login)
MAGIC_LINK_JWT_SECRET=your-magic-link-secret-hex
MAGIC_LINK_TTL_MINUTES=1440

# Email/Password (optional; if using email+password auth)
EMAIL_PASSWORD_JWT_SECRET=your-email-password-jwt-secret-here
EMAIL_PASSWORD_TOKEN_TTL_MINUTES=1440

# Intercom (Identity Verification)
# App ID is also set on the frontend via VITE_INTERCOM_APP_ID.
# Secret is found in Intercom Dashboard → Settings → Security → Identity Verification.
INTERCOM_APP_ID=your-intercom-app-id
INTERCOM_SECRET=your-intercom-identity-verification-secret

# Azure Communication Services (email sending)
AZURE_COMMUNICATION_CONNECTION_STRING=endpoint=https://....communication.azure.com/;accesskey=...
AZURE_COMMUNICATION_SENDER_EMAIL=DoNotReply@your-resource.azurecomm.net

# --- If you see "signature verification failed" on sign-in (Microsoft/Google): ---
# 1. Backend AZURE_TENANT_ID = tenant of the users signing in (or ensure token issuer is parsed correctly).
# 2. Backend AZURE_CLIENT_ID = same app as frontend MSAL client ID (VITE_MSAL_CLIENT_ID).
# 3. Frontend and backend use the same Azure app registration (same Client ID).
# 4. Run backend with NODE_ENV=development and check logs for token iss, extracted tenant, and JWKS URL.
